## 평범한 배낭
|풀이 사이트|문제이름|난이도|
|:---:|:---:|:---:|
|[백준](https://www.acmicpc.net/problem/12865)|평범한 배낭|골드5|

### 문제 풀이

주어진 무게 K와 주어진 물건의 무게 W와 가치 V를 가치가 최대값이 되도록 물건의 무게를 문제이다.

가치가 최대가 되도록 무게에 맞는 물건을 들고가는 값을 찾는 과정은 다음과 같다.

예시 1 )
`K = 7`
|무게(W)|가치(V)|
|-|-|
|6|13|
|4|8|
|3|6|
|5|12|

dp[i]는 i만큼의 무게일 때, 가치 V의 최대값이다.

예를 들어 `dp[3] = 6`이 된다. 우리가 구하고자 하는 건 `dp[7]` 이다.
만약 배낭에 `무게 6, 가치 13` 물건을 넣는다고 가정했을 때, `dp[7]`의 값은 `dp[6]`에서 더 이상 추가할 수 있는 물건이 존재하지 않기 때문에 `dp[6]`과 같은 `13`이 된다.

하지만 `[3,6]` 물건과 `[4,8]` 물건을 넣게 되면 `7kg`이면서, 가치는 `14`를 가지게 된다. 그래서 위 예시의 경우 `dp[7]`의 값은 `14`가 되어야 한다.

이 값을 찾는 과정은 다음과 같다.

|||||||
|-|-|-|-|-|-|
|무게|1|2|3|4|5|6|7|
|가치|-|-|6|-|-|-|-|

먼저 물건의 정보가 담긴 배열을 무게를 기준으로 정렬한다. 그 후 첫번째 물건의 정보를 dp[] 배열에 갱신한다. 무게가 3일 때, 가치 최대의 값은 6이다

다음은 `[무게:4, 가치:8]` 인 물건의 갱신 결과이다.
 
|||||||||
|-|-|-|-|-|-|-|:-:|
|무게|1|2|3|4|5|6|7|
|가치|-|-|6|8|-|-|14|

무게가 4인 물건의 정보를 갱신하려고 할 때, 만약 `dp[i] != 0 조건`을 만족하는 경우가 있다면, `dp[i + 물건의 무게] = dp[i] + 물건의 가치` 로 설정한다. 이 떄 기존에 다른 경우에 대한 갱신된 값이 있을 수 있으니, 최대값으로 계산한다.

```
dp[i + 물건의 무게] = max(dp[i + 물건의 무게], dp[i]+물건의 가치)
```

이런식으로 계속 반복하다 보면 다음과 같은 결과가 나온다.

|||||||||
|-|-|-|-|-|-|-|:-:|
|무게|1|2|3|4|5|6|7|
|가치|-|-|6|8|12|13|14|

이 방법은 0 ~ K까지 dp 배열을 조회한다. 즉 순차적으로 dp 배열을 조회한다. 

다음 예시를 한번 살펴보자.

예시 2 )

`K = 2`
|무게(W)|가치(V)|
|-|-|
|1|2|
|1|3|
|1|4|

다음은 위 내용대로 구성된 가치 갱신의 과정이다.

(1)
|||||
|-|-|-|-|
|무게|1|2|3|
|가치|2|-|-|

(2)
|||||
|-|-|-|-|
|무게|1|2|3|
|가치|3|5|-|

(3)
|||||
|-|-|-|-|
|무게|1|2|3|
|가치|4|7|11|

`dp[3]`의 값이 좀 이상하다. dp[3] = 9가 정답이지만, 위 로직대로 풀면 11이 나왔다. 이는 `[무게:1, 가치:4]`인 물건이 2번 쓰였다. 

(2) 과정이 끝나고, `[무게:1, 가치:4]` 물건의 갱신이 시작된다. 이 때 `무게 2`의 최대 가치가 변경이 되는데, 바로 `가치:3` 물건과 해당 물건의 가치가 `무게 2`로 최대 가치로 갱신된다. 그리고 `i = 2` 가 되었을 때, (2) 과정이 끝났을 때의 배열이 아닌, 실시간으로 갱신된 가치를 기준으로 하기 때문에 7의 값에 4를 더하여 dp[3]에 갱신한다. 바로 이 점이 문제가 된다.

이는 배열을 0 -> K로 순회하면서 생긴 알고리즘 오류이다. 최대값 갱신은 모두 이전 과정의 배열을 기준으로 해야한다. 만약 (3) 과정에서 최대값을 갱신할 때, i가 증가하면서 갱신된 배열을 기준으로 갱신하는 것이 아니라, (2) 배열을 기준으로 해야한다. 

이전 배열을 복사해서 값을 갱신할 수도 있겠지만, 배열을 거꾸로 돌면 간단하게 해결할 수 있다.
`(i == 물건의 무게 일 때는 상관없다.)`

배열을 거꾸로 순회하며, 최대 가치를 갱신하면 결과는 아래와 같다.

(2)
|||||
|-|-|-|-|
|무게|1|2|3|
|가치|3|5|-|

(3)
|||||
|-|-|-|-|
|무게|1|2|3|
|가치|3|5|9| 

|||||
|-|-|-|-|
|무게|1|2|3|
|가치|3|7|9|

|||||
|-|-|-|-|
|무게|1|2|3|
|가치|4|7|9|

물론 `i = 물건의 무게` 일 때, 최대 가치를 갱신하는 코드는 `누적 최대 가치`를 계산하는 코드보다 뒤에 있어야 한다.