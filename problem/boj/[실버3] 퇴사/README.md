## 퇴사

|풀이 사이트|문제이름|난이도|
|:---:|:---:|:---:|
|[백준](https://www.acmicpc.net/problem/14501)|퇴사|실버3|

### 문제 풀이

퇴사일까지 남은 기간 중 주어진 일들 중에 최대로 수익을 올릴 수 있도록 최대 수익을 계산하는 문제이다. 여기서 `dp[N]`은 `N일`에 벌 수 있는 최대 수익이다.

먼저 날짜를 잘라서 확인하는 편이 좋다.

|Day|1|2|3|
|-|-|-|-|
|소요일|3|5|1|
|수익|10|20|10

이런식으로 있을 떄, `1일째` 상담은 3일째에 끝난다. 그리고 `3일째`의 상담은 당일에 끝난다. 이 날의 수익은 모두 `10`으로 같다. 하지만 만약 `3일째` 수익이 `20`이라면 `dp[3] = 20`이 된다.

기존에 얻을 수 있는 수익과 3일째에 누적된 이익을 합한 것 중 더 큰 값을 dp[3]에 저장한다.

만약 다음과 같은 상황이 벌어지면 얘기가 다르다

|Day|1|2|3|
|-|-|-|-|
|소요일|3|1|1|
|수익|10|10|10

`1일차`의 경우 `3일차` 수익을 `10원` 벌 수 있다 하지만, `1일차`의 상담을 하지 않고, `2일차`, `3일차`의 상담을 하게 되면 `3일차`에 얻는 수익은 `총 20원`으로 더 많다.

dp 배열은 dp[i] 값에 해당 날에 벌 수 있는 최대의 수익이 정해져야 하기 때문에 코드는 다음과 같다.

```java
if (time == 1) {
    dp[i] = Math.max(dp[i], dp[i-1] + money);
}
```

이와 같은 경우는 특수한 경우이고, 일반적인 경우는 다음과 같다.

|Day|1|2|3|4|5|6|7|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|소요일|3|5|1|1|2|4|2|
|수익|10|20|10|20|15|40|200

이 값들을 하나씩 반복문을 통해 아래 설명과 같이 살펴보자.

|Day|1|2|3|4|5|6|7|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|소요일|3|5|1|1|2|4|2|
|수익|10|20|10|20|15|40|200|
|누적|0|0|10|-|-|20|-|

반복문이 `3일차` 까지만 이루어졌을 때, 누적 값은 다음과 같다. 그리고 4일차까지 이뤄지면 위에 적어둔 조건문 통해  `30` 이라는 누적값이 갱신된다.

|Day|1|2|3|4|5|6|7|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|소요일|3|5|1|1|2|4|2|
|수익|10|20|10|20|15|40|200|
|누적|0|0|10|30|-|20|-|

왜냐면 기존 dp[4]에는 0이 있었고, `Math.max(dp[4], dp[3] + money) (3일차 최대 수익 + 4일 상담의 수익)` 를 통해 누적값이 갱신된다.

5일차가 됐을 때, 5일차는 소요일이 1일이 아니기 때문에 이전 날짜의 누적 값을 갱신한다. 그리고 해당 일로부터 상담이 끝나는 날짜의 값도 갱신한다. 

|Day|1|2|3|4|5|6|7|
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
|소요일|3|5|1|1|2|4|2|
|수익|10|20|10|20|15|40|200|
|누적|0|0|10|30|30|45|-|

갱신할 때, dp[5] + money의 값으로 갱신하게 된다. 이 때의 점화식은 다음과 같다.
```
dp[i+time-1] = Math.max(dp[i+time-1], dp[i-1] + money)
```

뒤에 dp[i-1]을 하는 이유는, `dp[i] = Math.max(dp[i], dp[i-1])`을 통해 dp[i] 값을 갱신한다. 

|Day|1|2|3|4|5|
|:-:|:-:|:-:|:-:|:-:|:-:|
|소요일|3|2|3|1|1|
|수익|10|20|10|20|15|
|누적|0|0|20|40|max(10, 55)|

위 표를 자세히 보자, `1일차`, `2일차`의 비교에 의해 `3일차`의 값이 `20`이고, `3일차`가 진행될 때, `dp[5]`의 값이 `10`으로 설정된다. 이때는 왜 그럴까? `3일차` 수익은 상담이 종료됐을 때, 얻을 수 있다. `dp[3]`에 누적된 `20`의 수익은 상담이 끝난 후 얻은 수익이다. 그래서 `3일차`에 시작하는 상담의 누적 값에 누적될 수 없다.

3일차에 누적이 될 수 있는 것은 `dp[2]`의 값이다. 하지만 `dp[2]`의 값은 0이고, `1일차`, `2일차`에 의해 `dp[3]`에는 `20`이라는 수익이 설정되어, `dp[3] = 20`이 된다.

이를 통해 점화식을 구성한 코드는 다음과 같다.

```java
// time과 money는 i일에 해당하는 소요일과 수익이다.
for (int i=1; i<=N; i++) {
    int time = sche[i][0];
    int money = sche[i][1];

    if (time == 1) {
        dp[i] = Math.max(dp[i], dp[i-1] + money);
    } else {
        dp[i] = Math.max(dp[i], dp[i-1]);
        dp[i + (time-1)] = Math.max(dp[i+(time-1)], dp[i-1] + money);
    }
}
```



